<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
    <title>Blog kulinarny</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}"/>
    <script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
    <script th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
    <div th:replace="header :: header"></div>
</head>

<body>
<script>
    function confirmRemove() {
        if(!confirm("Czy na pewno chcesz bezpowrotnie usunąć ten przepis wraz z komentarzami?"))
            return false;
        return true;
    }
</script>
<div th:object="${recipe}">
    <div align="center">
        <h1><p th:text="*{name}"/></h1>
        <a sec:authorize="hasAuthority('blogger')" th:href="@{'/przepis/modyfikuj/edytuj/' + *{id}}">Edytuj</a>
        <a sec:authorize="hasAuthority('blogger')" th:href="@{'/przepis/modyfikuj/usun/' + *{id}}" onclick="return confirmRemove()">Usuń</a>
        <IMG th:src="@{*{imageLink}}" ALT="some text" WIDTH=700 HEIGHT=700>
    </div>
    <p>Kategorie:</p> <i th:each="cattegory : ${recipe.cattegories}" th:text="${cattegory.cattegory.name} + ' '"></i>
    <br/>
    <p>Tagi</p> <a th:each="tag : ${recipe.tags}" th:href="@{'/tag/' + ${tag.tagName}}"><i th:text="${tag.tagName} + ' '"></i></a>
    <br/>
    <h3>Składniki:</h3>
    <pre th:text="*{ingredients}"></pre>
    <br/>
    <h3>Przygotowanie:</h3>
    <pre th:text="*{instruction}"></pre>
    <br/>
    <h1>Komentarze</h1>
    <form sec:authorize="isAuthenticated()" th:object="${comment}" th:method="post" th:action="@{/przepis/dodajKomentarz}">
        <input type="hidden" th:value="${recipe.id}" name="recipeId"/>
        <br/>
        <textarea type="text" rows="4" cols="50" th:field="*{text}"/>
        <br/>
        <button type="submit">Skomentuj</button>
    </form>
    <div class="comment" th:each="comment : *{comments}">
        <b><p th:text="${comment.userDetails.user.username}"/></b>
        <p th:text="${comment.text}"/>
    </div>


</div>
</body>
</html>